#include<iostream>
#include<set>
#include<vector>
#include<algorithm>

using namespace std;
const int maxn = 3e5 + 5;
long long a[maxn], pref[maxn], dp[maxn], trace[maxn];